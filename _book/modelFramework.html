<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Model Framework | Bayesian Multi-Object Response Regression</title>
  <meta name="description" content="Chapter 2 Model Framework | Bayesian Multi-Object Response Regression" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Model Framework | Bayesian Multi-Object Response Regression" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Model Framework | Bayesian Multi-Object Response Regression" />
  
  
  

<meta name="author" content="Rene Gutierrez Marquez" />


<meta name="date" content="2023-08-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="posteriorComputation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#package-description"><i class="fa fa-check"></i><b>1.1</b> Package Description</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#package-requierments"><i class="fa fa-check"></i><b>1.2</b> Package Requierments</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#package-installation"><i class="fa fa-check"></i><b>1.3</b> Package Installation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#document-structure"><i class="fa fa-check"></i><b>1.4</b> Document Structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelFramework.html"><a href="modelFramework.html"><i class="fa fa-check"></i><b>2</b> Model Framework</a></li>
<li class="chapter" data-level="3" data-path="posteriorComputation.html"><a href="posteriorComputation.html"><i class="fa fa-check"></i><b>3</b> Posterior Computation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="posteriorComputation.html"><a href="posteriorComputation.html#fullConditionalPsiA"><i class="fa fa-check"></i><b>3.1</b> Full Conditional for <span class="math inline">\( {\boldsymbol \psi} ^a_{p,.}\)</span></a></li>
<li class="chapter" data-level="3.2" data-path="posteriorComputation.html"><a href="posteriorComputation.html#fullConditionalPsiG"><i class="fa fa-check"></i><b>3.2</b> Full conditional for <span class="math inline">\( {\boldsymbol \psi} ^g_{p,.}\)</span></a></li>
<li class="chapter" data-level="3.3" data-path="posteriorComputation.html"><a href="posteriorComputation.html#full-conditional-for-xi_p-boldsymbol-theta-_-pp-and-boldsymbol-beta-_p"><i class="fa fa-check"></i><b>3.3</b> Full conditional for <span class="math inline">\(\xi_p\)</span>, <span class="math inline">\( {\boldsymbol \Theta} _{-p,p}\)</span> and <span class="math inline">\( {\boldsymbol \beta} _p\)</span></a></li>
<li class="chapter" data-level="3.4" data-path="posteriorComputation.html"><a href="posteriorComputation.html#full-conditional-for-tau2_theta"><i class="fa fa-check"></i><b>3.4</b> Full Conditional for <span class="math inline">\(\tau^2_\theta\)</span></a></li>
<li class="chapter" data-level="3.5" data-path="posteriorComputation.html"><a href="posteriorComputation.html#full-conditional-for-tau2_beta"><i class="fa fa-check"></i><b>3.5</b> Full Conditional for <span class="math inline">\(\tau^2_\beta\)</span></a></li>
<li class="chapter" data-level="3.6" data-path="posteriorComputation.html"><a href="posteriorComputation.html#full-conditional-nu"><i class="fa fa-check"></i><b>3.6</b> Full conditional <span class="math inline">\(\nu\)</span></a></li>
<li class="chapter" data-level="3.7" data-path="posteriorComputation.html"><a href="posteriorComputation.html#full-conditional-for-the-horseshoe-structure"><i class="fa fa-check"></i><b>3.7</b> Full Conditional for the Horseshoe Structure</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#bmrr_sampler"><i class="fa fa-check"></i><b>4.1</b> <code>bmrr_sampler</code></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="functions.html"><a href="functions.html#desription"><i class="fa fa-check"></i><b>4.1.1</b> Desription</a></li>
<li class="chapter" data-level="4.1.2" data-path="functions.html"><a href="functions.html#inputs"><i class="fa fa-check"></i><b>4.1.2</b> Inputs</a></li>
<li class="chapter" data-level="4.1.3" data-path="functions.html"><a href="functions.html#output"><i class="fa fa-check"></i><b>4.1.3</b> Output</a></li>
<li class="chapter" data-level="4.1.4" data-path="functions.html"><a href="functions.html#walkthrough"><i class="fa fa-check"></i><b>4.1.4</b> Walkthrough</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#bmrr_iterator"><i class="fa fa-check"></i><b>4.2</b> <code>bmrr_iterator</code></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="functions.html"><a href="functions.html#description"><i class="fa fa-check"></i><b>4.2.1</b> Description</a></li>
<li class="chapter" data-level="4.2.2" data-path="functions.html"><a href="functions.html#inputs-1"><i class="fa fa-check"></i><b>4.2.2</b> Inputs</a></li>
<li class="chapter" data-level="4.2.3" data-path="functions.html"><a href="functions.html#output-1"><i class="fa fa-check"></i><b>4.2.3</b> Output</a></li>
<li class="chapter" data-level="4.2.4" data-path="functions.html"><a href="functions.html#walkthrough-1"><i class="fa fa-check"></i><b>4.2.4</b> Walkthrough</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#group_iterator"><i class="fa fa-check"></i><b>4.3</b> <code>group_iterator</code></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="functions.html"><a href="functions.html#description-1"><i class="fa fa-check"></i><b>4.3.1</b> Description</a></li>
<li class="chapter" data-level="4.3.2" data-path="functions.html"><a href="functions.html#inputs-2"><i class="fa fa-check"></i><b>4.3.2</b> Inputs</a></li>
<li class="chapter" data-level="4.3.3" data-path="functions.html"><a href="functions.html#output-2"><i class="fa fa-check"></i><b>4.3.3</b> Output</a></li>
<li class="chapter" data-level="4.3.4" data-path="functions.html"><a href="functions.html#walktrhough"><i class="fa fa-check"></i><b>4.3.4</b> Walktrhough</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Multi-Object Response Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelFramework" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Model Framework<a href="modelFramework.html#modelFramework" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The main function of the package is <code>bmrr_sampler</code> which obtains samples
according to the method described on the paper in section 3. For every
observation <span class="math inline">\(i \in \{1,\ldots,n\}\)</span>:</p>
<ul>
<li><span class="math inline">\(y_i \in \mathbb{R}\)</span>: An scalar variable of interest.</li>
<li><span class="math inline">\(\mathbf{A}_i \in \mathbb{R}^{P \times P}\)</span> A network object, represented as
a symmetric matrix of <span class="math inline">\(P\)</span> by <span class="math inline">\(P\)</span>, where we disregard the diagonal entries.</li>
<li><span class="math inline">\(\mathbf{g}_{i,p} \in \mathbb{R}^{V_p}\)</span> for <span class="math inline">\(p \in {1,\ldots,P}\)</span> voxel
elements referenced by the same <span class="math inline">\(P\)</span> regions as the Network object. Notice
that we allow for the voxel elements to vary in size across the <span class="math inline">\(P\)</span> regions.</li>
<li><span class="math inline">\(\mathbf{x}_i \in \mathbb{R}^H\)</span> A vector of other covariates that can be
taken into consideration.</li>
</ul>
<p>Then we consider the following linear models:</p>
<p><span class="math display" id="eq:scalarNetworkEquation">\[\begin{equation}
a_{i,(p,p)} = \sum_{h=1}^H \psi^a_{p,h}\psi^a_{p&#39;,h} x_{i,h} + \theta_{p,p&#39;}y_i + e_i^{(p,p&#39;) \quad p &lt; p&#39;} \tag{2.1}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:scalarVoxelEquation">\[\begin{equation}
g_{i,(v,p)} = \sum_{h=1}^H \psi^g_{p,h} x_{i,h} + \beta_{v,p}y_i + w_i^{(p,p&#39;)} \quad {p\in{1&lt;\ldots,P}, \quad v\in{1,\ldots,V_p}}
\tag{2.2}
\end{equation}\]</span></p>
<p>, where
<span class="math display" id="eq:networkNoise">\[\begin{equation}
e_i^{(p,p&#39;)} \stackrel{iid}{\sim} N(0, \tau^2_{\theta}) \tag{2.3}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:voxelNoise">\[\begin{equation}
w_i^{(v,p)} \stackrel{iid}{\sim} N(0, \tau^2_{\beta}) \tag{2.4}
\end{equation}\]</span></p>
<p>We can also represent this regression equations in stacked format as follows:
<span class="math display" id="eq:stackedNetworkEquation">\[\begin{equation}
\mathbf{A}_i = \sum_{h=1}^H \mathbf{\Psi}^a_{p,h} x_{i,h} + \mathbf{\Theta}y_i + E_i \tag{2.5}
\end{equation}\]</span>
<span class="math display" id="eq:stackedVoxelEquation">\[\begin{equation}
\mathbf{g}_{i,p} = \sum_{h=1}^H \mathbf{1}_{V_p} \psi^g_{h,p} x_{i,h} + \mathbf{\beta}_p y_i + \mathbf{w}_{i,p} \tag{2.6}
\end{equation}\]</span></p>
<p>where we have stacked the elements as follows:</p>
<p><span class="math display">\[ \mathbf{A}_i \in \mathbb{R}^{P \times P}, \quad [\mathbf{A}_i]_{p,p&#39;}=[\mathbf{A}_i]_{p&#39;,p}=a_{i,(p,p&#39;)} \quad \text{for} \quad p &lt; p&#39;, \quad  [\mathbf{A}_i]_{p,p} = 0 \quad \text{for} \quad p = p&#39;\]</span>
<span class="math display">\[ \mathbf{\Psi} \in \mathbb{R}^{P \times P}, \quad [\mathbf{\Psi}^a]_{p,p&#39;} = [\mathbf{\Psi}^a]_{p&#39;,p} = \psi_{p,h}^a \psi_{p&#39;,h}^a, \quad \text{for} \quad p &lt; p&#39;, \quad  [\mathbf{\Psi}^a]_{p,p} = 0 \quad \text{for} \quad p = p&#39; \]</span></p>
<p><span class="math display">\[ \mathbf{\Theta} \in \mathbb{R}^{P \times P}, \quad [\mathbf{\Theta}]_{p,p&#39;} = [\mathbf{\Theta}]_{p&#39;,p} = \theta_{p,p&#39;} \quad \text{for} \quad p &lt; p&#39;, \quad [\mathbf{\Theta}]_{p,p} = 0 \quad \text{for} \quad p = p&#39; \]</span>
<span class="math display">\[ \mathbf{E}_i \in \mathbb{R}^{P \times P}, \quad [\mathbf{E}_i]_{p,p&#39;}=[\mathbf{E}_i]_{p&#39;,p}=a_{i,(p,p&#39;)} \quad \text{for} \quad p &lt; p&#39;, \quad  [\mathbf{E}_i]_{p,p} = 0 \quad \text{for} \quad p = p&#39; \]</span>
<span class="math display">\[ \mathbf{g}_{i,p} \in \mathbb{R}^{V_p}, \quad \mathbf{g}_{i,p}=(g_{i,1,p},\ldots,g_{i,V_p,p}) \quad \text{for} \quad p \in \{1,\ldots,P\}\]</span>
<span class="math display">\[ \mathbf{1}_{V_p} \in \mathbb{R}^{V_p}, \quad \text{A vector of ones.}\]</span>
<span class="math display">\[ \mathbf{w}_{i,p} \in \mathbb{R}^{V_p}, \quad \mathbf{w}_{i,p}=(w_{i,1,p},\ldots,w_{i,V_p,p}) \quad \text{for} \quad p \in \{1,\ldots,P\}\]</span></p>
<p>The main focus of analysis are the <span class="math inline">\(\mathbf{A}_i\)</span>, <span class="math inline">\(\mathbf{g}_{i,p}\)</span> and <span class="math inline">\(y_i\)</span> elements. Objects <span class="math inline">\(\mathbf{A}_i\)</span> and <span class="math inline">\(\mathbf{g}_{i,p}\)</span> are related through the regions <span class="math inline">\(p\)</span>. This connection is developed further in the prior distributions.</p>
<p>The prior for the Network coefficients is set as follows:</p>
<p><span class="math display" id="eq:networkPrior">\[\begin{equation}
\theta_{p,p&#39;}| \lambda_{p,p&#39;},\tau^2_\theta,\sigma_\theta,\xi_p,\xi_{p&#39;} \stackrel{ind.}{\sim} \xi_p \xi_{p&#39;}N(0, \tau^2_\theta \sigma^2_\theta \lambda^2_{p,p&#39;}) + (1-\xi_p \xi_{p&#39;}) \delta_0 \quad p &lt; p&#39;)
\tag{2.7}
\end{equation}\]</span></p>
<p>while the prior for the Voxel coefficients is:</p>
<p><span class="math display" id="eq:voxelkPrior">\[\begin{equation}
\mathbf{\beta}_{v,p}|\phi^2_{v,p},\eta_p^2,\tau^2_\beta, \xi_p \stackrel{ind.}{\sim} \xi_p N(0, \tau^2_\beta \eta_p^2 \phi^2_{v,p}) \mathbf{\gamma}_p + (1-\xi_p ) \delta_0  \quad v \in \{1,\ldots,V_p\} \quad p \in \{1,\ldots,P\}
\tag{2.8}
\end{equation}\]</span></p>
<p>That is, a region specific Spike and Slab prior on the Network and Voxel coefficients is applied, that simultaneously determines
which regions are relevant through the spike indicators <span class="math inline">\(\xi_p\)</span> <span class="citation">(<a href="#ref-george1997approaches">George and McCulloch 1997</a>)</span>. The spike component of the the coefficients is given a Horseshoe structure <span class="citation">(<a href="#ref-carvalho2010horseshoe">Carvalho, Polson, and Scott 2010</a>)</span>. Then the Horseshoe structure for the Network coefficients is set as:</p>
<p><span class="math display">\[\sigma_\theta \sim C^+(0,1) \]</span>
<span class="math display">\[\lambda_{p,p&#39;} \stackrel{iid}{\sim} C^+(0,1) \quad p \in \{1,\ldots,P\} \]</span>
The Horseshoe structure for the Voxel Coefficients is given by:</p>
<p><span class="math display">\[\eta^2_p \stackrel{iid}{\sim} C^+(0,1) \quad p \in \{1,\ldots,P\} \]</span></p>
<p><span class="math display">\[\phi_{v,p} \stackrel{iid}{\sim} C^+(0,1) \quad v \in \{1,\ldots,V_p\} \quad p \in \{1,\ldots,P\} \]</span></p>
<p>For the spike indicators, the prior is set as:
<span class="math display">\[  \xi_p \stackrel{iid}{\sim} Ber(\nu) \]</span>
<span class="math display">\[ \nu \sim Beta(a_\nu, b_\nu) \]</span>
where a Beta prior is assigned to the Bernoulli prior probability to account for multiplicity correction.</p>
<p>Inverse-Gamma priors are assigned to the error variances:
<span class="math display">\[ \tau^2_\theta \sim IG(a_{\tau_\theta}, b_{\tau_\theta}) \]</span>
<span class="math display">\[ \tau^2_\beta \sim IG(a_{\tau_\beta}, b_{\tau_\beta}) \]</span></p>
<p>Finally, for the other covariate coefficients:</p>
<p><span class="math display">\[ \psi_{p,h}^a,\psi^g_{p,h} \propto 1 \quad p \in \{1,\ldots,P\}, \quad h \in \{1,\ldots,H\} \]</span></p>

</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-carvalho2010horseshoe" class="csl-entry">
Carvalho, Carlos M, Nicholas G Polson, and James G Scott. 2010. <span>“The Horseshoe Estimator for Sparse Signals.”</span> <em>Biometrika</em> 97 (2): 465–80.
</div>
<div id="ref-george1997approaches" class="csl-entry">
George, Edward I, and Robert E McCulloch. 1997. <span>“Approaches for <span>B</span>ayesian Variable Selection.”</span> <em>Statistica Sinica</em> 7: 339–73.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="posteriorComputation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-model-framework.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
